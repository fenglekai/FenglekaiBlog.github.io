{"title":"前端文件上传与下载","date":"2022-06-27T01:13:37.000Z","date_formatted":{"ll":"2022年6月27日","L":"2022/06/27","MM-DD":"06-27"},"thumbnail":"https://picsum.photos/1280/720?random=11","color":"#111","link":"2022/06/27/前端文件上传与下载","tags":["🍕JS"],"updated":"2023-02-13T07:34:07.829Z","content":"<h3 id=\"html文件上传\">HTML文件上传<a title=\"#html文件上传\" href=\"#html文件上传\"></a></h3>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">ref</span>=<span class=\"string\">&quot;select&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">type</span>=<span class=\"string\">&quot;file&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">class</span>=<span class=\"string\">&quot;form&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">hidden</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">accept</span>=<span class=\"string\">&quot;application/dxf&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">multiple</span>=<span class=\"string\">&quot;multiple&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">/&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>type控制input类型</li>\n<li>hidden控制元素显示隐藏</li>\n<li>accept控制上传类型</li>\n<li>multiple是否可以多选</li>\n</ul>\n<h3 id=\"文件上传进度条\">文件上传进度条<a title=\"#文件上传进度条\" href=\"#文件上传进度条\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 在axios下配置request Header</span></span><br><span class=\"line\"><span class=\"attr\">onUploadProgress</span>: <span class=\"function\">(<span class=\"params\">progressEvent</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(progressEvent.lengthComputable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> complete = </span><br><span class=\"line\">            (((progressEvent.loaded / progressEvent.total) * <span class=\"number\">100</span>) | <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.percentage = complete;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (complete === <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.percentage = <span class=\"number\">0</span> <span class=\"comment\">// 重置进度</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"文件下载\">文件下载<a title=\"#文件下载\" href=\"#文件下载\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 文件链接直接下载</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> a = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> url = <span class=\"string\">&quot;url&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> fileName = <span class=\"string\">&quot;filename.xlsx&quot;</span>;</span><br><span class=\"line\">a.herf = url;</span><br><span class=\"line\">a.download = fileName;</span><br><span class=\"line\">a.click();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 后端blob流文件下载</span></span><br><span class=\"line\">fetch(url).then(<span class=\"function\">(<span class=\"params\">response</span>) =&gt;</span></span><br><span class=\"line\">  response.blob().then(<span class=\"function\">(<span class=\"params\">blob</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> a = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> url = <span class=\"built_in\">window</span>.URL.createObjectURL(blob);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> fileName = <span class=\"string\">&quot;filename.xlsx&quot;</span>;</span><br><span class=\"line\">    a.herf = url;</span><br><span class=\"line\">    a.download = fileName;</span><br><span class=\"line\">    a.click();</span><br><span class=\"line\">    <span class=\"built_in\">window</span>.URL.revokeObjectURL(url);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n","prev":{"title":"Canvas拖拽和缩放","link":"2023/02/13/Canvas拖拽和缩放"},"next":{"title":"学习路上的坑","link":"2022/06/27/奇奇怪怪的坑"},"plink":"https://fenglekai.github.io/2022/06/27/前端文件上传与下载/","toc":[{"id":"html文件上传","title":"HTML文件上传","index":"1"},{"id":"文件上传进度条","title":"文件上传进度条","index":"2"},{"id":"文件下载","title":"文件下载","index":"3"}],"reading_time":"201 字约 1 分钟"}