{"title":"å­¦ä¹ è·¯ä¸Šçš„å‘","date":"2022-06-27T01:02:02.000Z","date_formatted":{"ll":"2022å¹´6æœˆ27æ—¥","L":"2022/06/27","MM-DD":"06-27"},"thumbnail":"https://picsum.photos/1280/720?random=10","color":"#111","link":"2022/06/27/å¥‡å¥‡æ€ªæ€ªçš„å‘","tags":["ğŸ“”ç¬”è®°"],"updated":"2023-02-22T03:53:32.602Z","content":"<h3 id=\"mockjsçš„å‘\">mockjsçš„å‘<a title=\"#mockjsçš„å‘\" href=\"#mockjsçš„å‘\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åœ¨ node_modules/mockjs/dist/mock.js ä¸­çš„ </span></span><br><span class=\"line\"><span class=\"comment\">// å¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„æ•°æ®æ¨¡æ¿ ä¸Šé¢åŠ å…¥ä»¥ä¸‹ä»£ç  </span></span><br><span class=\"line\"><span class=\"title class_\">MockXMLHttpRequest</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">upload</span> = <span class=\"title function_\">createNativeXMLHttpRequest</span>().<span class=\"property\">upload</span></span><br></pre></td></tr></table></figure>\n<p>åŸå› æ˜¯ Mockjs ä¸­, å°è£…äº†åŸç”Ÿçš„ XMLHttpRequest ä¸º MockXMLHttpRequest. è§£å†³æ€è·¯æ˜¯, æŠŠåŸç”Ÿ XMLHttpRequest çš„ upload å±æ€§èµ‹ç»™ MockXMLHttpRequest çš„åŸå‹å¯¹è±¡</p>\n<p><strong>åæ¥å‘ç°è¿˜æ˜¯è§£å†³ä¸äº†é—®é¢˜ï¼Œæœ€ç®€å•çš„åŠæ³•è¿˜æ˜¯åˆ é™¤mockjsä¾èµ–â€¦</strong></p>\n<h3 id=\"command:--node-scripts/build.js\">command:  node scripts/build.js<a title=\"#command:--node-scripts/build.js\" href=\"#command:--node-scripts/build.js\"></a></h3>\n<p>ä¸»è¦æ˜¯windowså¹³å°ç¼ºå°‘ç¼–è¯‘ç¯å¢ƒï¼Œ</p>\n<blockquote>\n<p>1ã€å…ˆè¿è¡Œï¼š npm install -g node-gyp<br>\n2ã€ç„¶åè¿è¡Œï¼šè¿è¡Œ npm install --global --production windows-build-tools</p>\n</blockquote>\n<p>å¯ä»¥è‡ªåŠ¨å®‰è£…è·¨å¹³å°çš„ç¼–è¯‘å™¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm uninstall node-sass</span><br><span class=\"line\">npm i node-sass --sass_binary_site=https://npm.taobao.org/mirrors/node-sass/</span><br></pre></td></tr></table></figure>\n<p>æ¥ç€å°±å¯ä»¥</p>\n<blockquote>\n<p>npm install<br>\nnpm run dev</p>\n</blockquote>\n<h3 id=\"vite+vue3+ts-ä½¿ç”¨@åˆ«åçš„ä¸€äº›é—®é¢˜\">vite+vue3+ts ä½¿ç”¨@åˆ«åçš„ä¸€äº›é—®é¢˜<a title=\"#vite+vue3+ts-ä½¿ç”¨@åˆ«åçš„ä¸€äº›é—®é¢˜\" href=\"#vite+vue3+ts-ä½¿ç”¨@åˆ«åçš„ä¸€äº›é—®é¢˜\"></a></h3>\n<p>é¦–å…ˆéœ€è¦åœ¨vite.config.jsä¸­é…ç½®</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;</span><br><span class=\"line\">  defineConfig</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">  resolve</span><br><span class=\"line\">&#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">alias</span>: &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;@&#x27;</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;src&#x27;</span>),</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">extensions</span>: [<span class=\"string\">&quot;.js&quot;</span>, <span class=\"string\">&quot;.ts&quot;</span>, <span class=\"string\">&quot;.tsx&quot;</span>, <span class=\"string\">&quot;.jsx&quot;</span>]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [<span class=\"title function_\">vue</span>()]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>ç„¶åæ–°å»ºtsconfig.jsoné…ç½®</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;compilerOptions&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;target&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;module&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;strict&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;jsx&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;preserve&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;importHelpers&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;moduleResolution&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;node&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;skipLibCheck&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;esModuleInterop&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;allowSyntheticDefaultImports&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;sourceMap&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;baseUrl&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;.&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;types&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;vite/client&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;paths&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;@/*&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">                <span class=\"string\">&quot;src/*&quot;</span></span><br><span class=\"line\">            <span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;lib&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">            <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"string\">&quot;dom&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"string\">&quot;dom.iterable&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"string\">&quot;scripthost&quot;</span></span><br><span class=\"line\">        <span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;include&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"string\">&quot;src/**/*.ts&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"string\">&quot;src/**/*.tsx&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"string\">&quot;src/**/*.vue&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"string\">&quot;tests/**/*.ts&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"string\">&quot;tests/**/*.tsx&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"string\">&quot;typings&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;exclude&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"string\">&quot;node_modules&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"æœ€åè§£å†³tsä¸èƒ½è¯†åˆ«.vueæ–‡ä»¶çš„é—®é¢˜\">æœ€åè§£å†³tsä¸èƒ½è¯†åˆ«.vueæ–‡ä»¶çš„é—®é¢˜<a title=\"#æœ€åè§£å†³tsä¸èƒ½è¯†åˆ«.vueæ–‡ä»¶çš„é—®é¢˜\" href=\"#æœ€åè§£å†³tsä¸èƒ½è¯†åˆ«.vueæ–‡ä»¶çš„é—®é¢˜\"></a></h4>\n<p>æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶å¤¹typingsï¼Œæ–°å»ºæ–‡ä»¶shims-vue.d.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">module</span> <span class=\"string\">&#x27;*.vue&#x27;</span> &#123;<span class=\"comment\">// tså…¨å±€å®šä¹‰.vueæ–‡ä»¶åˆ¤æ–­</span></span><br><span class=\"line\">    <span class=\"keyword\">import</span> <span class=\"keyword\">type</span> &#123; <span class=\"title class_\">DefineComponent</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"attr\">component</span>: <span class=\"title class_\">DefineComponent</span>&lt;&#123;&#125;, &#123;&#125;, <span class=\"built_in\">any</span>&gt;</span><br><span class=\"line\">    <span class=\"keyword\">export</span> <span class=\"keyword\">default</span> component</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"viteæ‰“åŒ…åè®¿é—®ç™½å±ã€è·¨åŸŸæŠ¥é”™é—®é¢˜\">viteæ‰“åŒ…åè®¿é—®ç™½å±ã€è·¨åŸŸæŠ¥é”™é—®é¢˜<a title=\"#viteæ‰“åŒ…åè®¿é—®ç™½å±ã€è·¨åŸŸæŠ¥é”™é—®é¢˜\" href=\"#viteæ‰“åŒ…åè®¿é—®ç™½å±ã€è·¨åŸŸæŠ¥é”™é—®é¢˜\"></a></h3>\n<p>åœ¨vite.config.jsæ·»åŠ <code>base: './' </code></p>\n<p>æ¥è‡ª<a href=\"https://forum.vuejs.org/t/vite-2-vue-3-index-html/113281/3\" target=\"_blank\">vue issues</a> <strong>silentdepth</strong>çš„å›ç­”ï¼š</p>\n<blockquote>\n<p>é‚£æˆ‘å»ºè®®ä½ æ¢åˆ«çš„ bundlerã€‚Vite æ²¡æœ‰ä¸ºä¼ ç»Ÿæ¨¡å—ç³»ç»Ÿè®¾è®¡ï¼ŒES Modules æ˜¯å…¶ç‰¹æ€§åŸºçº¿ã€‚</p>\n<p>æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨åŸç”Ÿåº”ç”¨æ³¨å…¥è‡ªå®šä¹‰ scheme æ¥ä½¿ç”¨å†…åµŒé¡µé¢ï¼ˆ<code>example-app://</code> ä»€ä¹ˆçš„ï¼‰ï¼Œè¿™æ ·å¯ä»¥æ­£å¸¸æ¿€æ´» ES Modules ç‰¹æ€§ï¼Œä»ä¸€å¼€å§‹è§„é¿è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>å¦‚æœä½ å®åœ¨å¸Œæœ›ä½¿ç”¨ Vite åšå¼€å‘ï¼ŒåŒæ—¶åªèƒ½ä½¿ç”¨ <code>file:///</code>ï¼Œå¯ä»¥ä½¿ç”¨ <a href=\"https://github.com/vitejs/vite/tree/main/packages/plugin-legacy\" target=\"_blank\">@vitejs/plugin-legacy 39</a> ç”Ÿæˆ nomodule çš„ç‰ˆæœ¬ï¼Œç„¶åå¯¹ <code>dist/index.html</code> åšå¦‚ä¸‹æ”¹åŠ¨ï¼š</p>\n<ul>\n<li>ç§»é™¤ <code>&lt;script type=module&gt;</code> å…ƒç´ </li>\n<li>ç§»é™¤å…¶ä»– <code>&lt;script&gt;</code> çš„ <code>nomodule</code> å±æ€§</li>\n<li>ç§»é™¤ <code>&lt;script id=vite-legacy-entry&gt;</code> å…ƒç´ çš„å†…å®¹ï¼Œå¹¶æŠŠ <code>data-src</code> å±æ€§åæ”¹ä¸º <code>src</code></li>\n<li>ç§»é™¤ SystemJS loader ä»£ç ï¼ˆé‚£ä¸ªå‹ç¼©åˆ°ä¸€è¡Œçš„ <code>&lt;script&gt;</code>ï¼‰</li>\n<li>ä¿®æ”¹æ‰€æœ‰èµ„æºåœ°å€ä¸ºç›¸å¯¹åœ°å€ï¼ˆä¾‹å¦‚æŠŠ <code>/assets/index-legacy.xxxx.js</code> æ”¹ä¸º <code>./assets/index-legacy.xxxx.js</code>ï¼Œæ³¨æ„è¿˜æœ‰ CSS æ–‡ä»¶ï¼‰</li>\n</ul>\n<p>æˆ‘æ²¡æœ‰è¿™ä¹ˆå®è·µè¿‡ï¼Œä¸ç¡®å®šæ‰€æœ‰åŠŸèƒ½éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå»ºè®®éƒ¨ç½²å‰å……åˆ†æµ‹è¯•ã€‚</p>\n</blockquote>\n","prev":{"title":"å‰ç«¯æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½","link":"2022/06/27/å‰ç«¯æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½"},"next":{"title":"å¸¸ç”¨çš„å·¥å…·è½¯ä»¶","link":"2022/06/27/å¸¸ç”¨çš„å·¥å…·è½¯ä»¶"},"plink":"https://fenglekai.github.io/2022/06/27/å¥‡å¥‡æ€ªæ€ªçš„å‘/","toc":[{"id":"mockjsçš„å‘","title":"mockjsçš„å‘","index":"1"},{"id":"command:--node-scripts/build.js","title":"command:  node scripts&#x2F;build.js","index":"2"},{"id":"vite+vue3+ts-ä½¿ç”¨@åˆ«åçš„ä¸€äº›é—®é¢˜","title":"vite+vue3+ts ä½¿ç”¨@åˆ«åçš„ä¸€äº›é—®é¢˜","index":"3"},{"id":"viteæ‰“åŒ…åè®¿é—®ç™½å±ã€è·¨åŸŸæŠ¥é”™é—®é¢˜","title":"viteæ‰“åŒ…åè®¿é—®ç™½å±ã€è·¨åŸŸæŠ¥é”™é—®é¢˜","index":"4"}],"reading_time":"676 å­—çº¦ 5 åˆ†é’Ÿ"}