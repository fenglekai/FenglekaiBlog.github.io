{"title":"MySQL初始化配置","date":"2022-06-27T00:59:22.000Z","date_formatted":{"ll":"2022年6月27日","L":"2022/06/27","MM-DD":"06-27"},"thumbnail":"https://picsum.photos/1280/720?random=7","color":"#111","link":"2022/06/27/MySQL初始化配置","tags":["数据库"],"updated":"2023-02-13T07:34:07.829Z","content":"<h1 id=\"mysql初始化配置\">MySQL初始化配置<a title=\"#mysql初始化配置\" href=\"#mysql初始化配置\"></a></h1>\n<p>D:\\mysql-8.0.27-winx64根目录下配置</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[client]</span></span><br><span class=\"line\"><span class=\"comment\"># 设置mysql客户端默认字符集</span></span><br><span class=\"line\"><span class=\"attr\">default-character-set</span>=utf8</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"section\">[mysqld]</span></span><br><span class=\"line\"><span class=\"comment\"># 设置3306端口</span></span><br><span class=\"line\"><span class=\"attr\">port</span> = <span class=\"number\">3306</span></span><br><span class=\"line\"><span class=\"comment\"># 设置mysql的安装目录</span></span><br><span class=\"line\"><span class=\"attr\">basedir</span>=C:\\\\web\\\\mysql-<span class=\"number\">8.0</span>.<span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"comment\"># 设置 mysql数据库的数据的存放目录，MySQL 8+ 不需要以下配置，系统自己生成即可，否则有可能报错</span></span><br><span class=\"line\"><span class=\"comment\"># datadir=C:\\\\web\\\\sqldata</span></span><br><span class=\"line\"><span class=\"comment\"># 允许最大连接数</span></span><br><span class=\"line\"><span class=\"attr\">max_connections</span>=<span class=\"number\">20</span></span><br><span class=\"line\"><span class=\"comment\"># 服务端使用的字符集默认为8比特编码的latin1字符集</span></span><br><span class=\"line\"><span class=\"attr\">character-set-server</span>=utf8</span><br><span class=\"line\"><span class=\"comment\"># 创建新表时将使用的默认存储引擎</span></span><br><span class=\"line\"><span class=\"attr\">default-storage-engine</span>=INNODB</span><br></pre></td></tr></table></figure>\n<p>设置环境变量（可能没效果）</p>\n<p>在path添加<strong>D:\\mysql-8.0.27-winx64\\bin</strong>目录</p>\n<p>管理员命令行进入mysql根目录下</p>\n<p>初始化数据库</p>\n<p><code>.\\mysqld --initialize --console</code></p>\n<p>执行完成会出现初始密码记得备份方便以后修改</p>\n<p><code>root@localhost: APWCY5ws&amp;hjQ</code></p>\n<p>安装</p>\n<p><code>.\\mysql install</code></p>\n<p>启动和关闭mysql</p>\n<p><code>net start mysql</code></p>\n<p><code>net stop mysql</code></p>\n<p>登录</p>\n<p><code>.\\mysql -u root -p</code></p>\n<p>键入密码后执行更新密码，不然会一直提示你更新密码</p>\n<p><code>alter user 'root'@'localhost' identified by 'new password';</code></p>\n<p><code>flush privileges;</code></p>\n<h3 id=\"更新一个问题\">更新一个问题<a title=\"#更新一个问题\" href=\"#更新一个问题\"></a></h3>\n<p><strong>mysql8之前的加密规则是mysql_native_password,而在mysql8之后，加密规则是caching_sha2_password.</strong></p>\n<p>所以部分连接数据库会出现<code>Client does not support authentication protocol requested by server</code></p>\n<h4 id=\"查询方式\">查询方式<a title=\"#查询方式\" href=\"#查询方式\"></a></h4>\n<p><code>select host,user,plugin,authentication_string from mysql.user;</code></p>\n<h4 id=\"解决办法\">解决办法<a title=\"#解决办法\" href=\"#解决办法\"></a></h4>\n<ol>\n<li>更新你的连接服务加密方式</li>\n<li>修改mysql登录密码的加密规则</li>\n</ol>\n<h4 id=\"修改加密规则\">修改加密规则<a title=\"#修改加密规则\" href=\"#修改加密规则\"></a></h4>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span> identified <span class=\"keyword\">with</span> mysql_native_password <span class=\"keyword\">by</span> <span class=\"string\">&#x27;new password&#x27;</span>;</span><br><span class=\"line\">#更新<span class=\"keyword\">user</span>为root，host为<span class=\"operator\">%</span>的密码为<span class=\"keyword\">new</span> password(自己设置)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> identified <span class=\"keyword\">with</span> mysql_native_password <span class=\"keyword\">by</span> <span class=\"string\">&#x27;new password&#x27;</span>;</span><br><span class=\"line\">#更新<span class=\"keyword\">user</span>为root,host为localhost 的密码为<span class=\"keyword\">new</span> password</span><br></pre></td></tr></table></figure>\n<p>or</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> identified <span class=\"keyword\">by</span> <span class=\"string\">&#x27;new password&#x27;</span> password expire never;</span><br><span class=\"line\">#修改加密规则</span><br><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> identified <span class=\"keyword\">with</span> mysql_native_password <span class=\"keyword\">by</span> <span class=\"string\">&#x27;new password&#x27;</span>;</span><br><span class=\"line\">#更新一下用户的密码</span><br></pre></td></tr></table></figure>\n<p><code>flush privileges; #刷新权限</code></p>\n","prev":{"title":"npm代理设置","link":"2022/06/27/npm代理设置"},"next":{"title":"Git常用命令","link":"2021/12/06/Git常用命令"},"plink":"https://fenglekai.github.io/2022/06/27/MySQL初始化配置/","toc":[{"id":"mysql初始化配置","title":"MySQL初始化配置","index":"1","children":[{"id":"更新一个问题","title":"更新一个问题","index":"1.1"}]}],"reading_time":"494 字约 3 分钟"}